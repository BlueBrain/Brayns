# Copyright (c) 2015-2022, EPFL/Blue Brain Project
# All rights reserved. Do not distribute without permission.
#
# This file is part of Brayns <https://github.com/BlueBrain/Brayns>

set(BRAYNSNETWORK_HEADERS
  adapters/AnimationParametersAdapter.h
  adapters/ApplicationParametersAdapter.h
  adapters/BinaryParamAdapter.h
  adapters/BoxAdapter.h
  adapters/CameraAdapter.h
  adapters/ClipPlaneAdapter.h
  adapters/ColorMapAdapter.h
  adapters/FrameExportAdapter.h
  adapters/LightAdapter.h
  adapters/LoaderInfoAdapter.h
  adapters/ModelDescriptorAdapter.h
  adapters/ModelInstanceAdapter.h
  adapters/ModelParamsAdapter.h
  adapters/ModelTransferFunctionAdapter.h
  adapters/RendererPickResultAdapter.h
  adapters/RenderingParametersAdapter.h
  adapters/SceneAdapter.h
  adapters/StatisticsAdapter.h
  adapters/TransferFunctionAdapter.h
  adapters/TransformationAdapter.h
  adapters/UpdateModelAdapter.h
  adapters/VolumeParametersAdapter.h
  client/ClientBuffer.h
  client/ClientManager.h
  client/ClientRef.h
  client/RequestBuffer.h
  client/ClientSender.h
  common/CancellationToken.h
  common/Clock.h
  common/ErrorHandler.h
  common/ExtractMaterial.h
  common/ExtractModel.h
  common/FrameExporter.h
  common/ProgressHandler.h
  common/PropertyObjectSchema.h
  common/RateLimiter.h
  dispatch/RequestDispatcher.h
  entrypoint/Entrypoint.h
  entrypoint/EntrypointBuilder.h
  entrypoint/EntrypointFinder.h
  entrypoint/EntrypointRegistry.h
  entrypoint/EntrypointRef.h
  entrypoint/EntrypointRequest.h
  entrypoint/IEntrypoint.h
  entrypoint/ObjectEntrypoint.h
  entrypoint/PropertyObjectEntrypoint.h
  entrypoints/AddClipPlaneEntrypoint.h
  entrypoints/AddLightEntrypoint.h
  entrypoints/AddModelEntrypoint.h
  entrypoints/AnimationParametersEntrypoint.h
  entrypoints/ApplicationParametersEntrypoint.h
  entrypoints/CameraEntrypoint.h
  entrypoints/CameraParamsEntrypoint.h
  entrypoints/CancelEntrypoint.h
  entrypoints/ChunkEntrypoint.h
  entrypoints/ClearLightsEntrypoint.h
  entrypoints/ExitLaterEntrypoint.h
  entrypoints/ExportFramesEntrypoint.h
  entrypoints/ExportFramesToDiskEntryPoint.h
  entrypoints/GetClipPlanesEntrypoint.h
  entrypoints/GetExportFramesProgressEntrypoint.h
  entrypoints/GetInstancesEntrypoint.h
  entrypoints/GetLightsEntrypoint.h
  entrypoints/GetLoadersEntrypoint.h
  entrypoints/GetModelEntrypoint.h
  entrypoints/ImageJpegEntrypoint.h
  entrypoints/ImageStreamingModeEntrypoint.h
  entrypoints/InspectEntrypoint.h
  entrypoints/LoadersSchemaEntrypoint.h
  entrypoints/ModelPropertiesEntrypoint.h
  entrypoints/ModelTransferFunctionEntrypoint.h
  entrypoints/QuitEntrypoint.h
  entrypoints/RegistryEntrypoint.h
  entrypoints/RemoveClipPlanesEntrypoint.h
  entrypoints/RemoveLightsEntrypoint.h
  entrypoints/RemoveModelEntrypoint.h
  entrypoints/RendererEntrypoint.h
  entrypoints/RendererParamsEntrypoint.h
  entrypoints/RequestModelUploadEntrypoint.h
  entrypoints/ResetCameraEntrypoint.h
  entrypoints/SceneEntrypoint.h
  entrypoints/SchemaEntrypoint.h
  entrypoints/SnapshotEntrypoint.h
  entrypoints/StatisticsEntrypoint.h
  entrypoints/TriggerJpegStreamEntrypoint.h
  entrypoints/UpdateClipPlaneEntrypoint.h
  entrypoints/UpdateInstanceEntrypoint.h
  entrypoints/UpdateModelEntrypoint.h
  entrypoints/VersionEntrypoint.h
  entrypoints/VolumeParametersEntrypoint.h
  interface/INetworkInterface.h
  interface/NetworkInterface.h
  jsonrpc/JsonRpcException.h
  jsonrpc/JsonRpcFactory.h
  jsonrpc/JsonRpcMessages.h
  jsonrpc/JsonRpcRequest.h
  jsonrpc/JsonRpcParser.h
  jsonrpc/JsonRpcSender.h
  jsonrpc/RequestId.h
  messages/AddClipPlaneMessage.h
  messages/ChunkMessage.h
  messages/ExitLaterMessage.h
  messages/ExportFramesMessage.h
  messages/GetExportFramesProgressMessage.h
  messages/GetInstancesMessage.h
  messages/GetModelMessage.h
  messages/ImageBase64Message.h
  messages/ImageStreamingModeMessage.h
  messages/InspectMessage.h
  messages/LightMessage.h
  messages/ModelPropertiesMessage.h
  messages/RemoveClipPlanesMessage.h
  messages/RemoveLightsMessage.h
  messages/RemoveModelMessage.h
  messages/SchemaMessage.h
  messages/SnapshotMessage.h
  messages/VersionMessage.h
  plugin/NetworkManager.h
  socket/ClientSocket.h
  socket/ISocket.h
  socket/ServerSocket.h
  socket/SocketListener.h
  socket/SocketManager.h
  stream/StreamManager.h
  stream/StreamMonitor.h
  task/BinaryTask.h
  task/ITask.h
  task/JsonRpcTask.h
  task/TaskManager.h
  websocket/InputPacket.h
  websocket/OutputPacket.h
  websocket/WebSocket.h
)
  
set(BRAYNSNETWORK_SOURCES
  adapters/ModelTransferFunctionAdapter.cpp
  adapters/UpdateModelAdapter.cpp
  client/ClientBuffer.cpp
  client/ClientManager.cpp
  client/ClientRef.cpp
  client/ClientRequest.cpp
  client/ClientSender.cpp
  client/RequestBuffer.cpp
  common/CancellationToken.cpp
  common/ExtractMaterial.cpp
  common/ExtractModel.cpp
  common/FrameExporter.cpp
  common/PropertyObjectSchema.cpp
  common/RateLimiter.cpp
  dispatch/RequestDispatcher.cpp
  entrypoint/EntrypointFinder.cpp
  entrypoint/EntrypointRegistry.cpp
  entrypoint/EntrypointRef.cpp
  entrypoints/AddClipPlaneEntrypoint.cpp
  entrypoints/AddLightEntrypoint.cpp
  entrypoints/AddModelEntrypoint.cpp
  entrypoints/AnimationParametersEntrypoint.cpp
  entrypoints/ApplicationParametersEntrypoint.cpp
  entrypoints/CameraEntrypoint.cpp
  entrypoints/CameraParamsEntrypoint.cpp
  entrypoints/CancelEntrypoint.cpp
  entrypoints/ChunkEntrypoint.cpp
  entrypoints/ClearLightsEntrypoint.cpp
  entrypoints/ExitLaterEntrypoint.cpp
  entrypoints/ExportFramesEntrypoint.cpp
  entrypoints/ExportFramesToDiskEntryPoint.cpp
  entrypoints/GetClipPlanesEntrypoint.cpp
  entrypoints/GetExportFramesProgressEntrypoint.cpp
  entrypoints/GetInstancesEntrypoint.cpp
  entrypoints/GetLightsEntrypoint.cpp
  entrypoints/GetLoadersEntrypoint.cpp
  entrypoints/GetModelEntrypoint.cpp
  entrypoints/ImageJpegEntrypoint.cpp
  entrypoints/ImageStreamingModeEntrypoint.cpp
  entrypoints/InspectEntrypoint.cpp
  entrypoints/LoadersSchemaEntrypoint.cpp
  entrypoints/ModelPropertiesEntrypoint.cpp
  entrypoints/ModelTransferFunctionEntrypoint.cpp
  entrypoints/QuitEntrypoint.cpp
  entrypoints/RegistryEntrypoint.cpp
  entrypoints/RemoveClipPlanesEntrypoint.cpp
  entrypoints/RemoveLightsEntrypoint.cpp
  entrypoints/RemoveModelEntrypoint.cpp
  entrypoints/RendererEntrypoint.cpp
  entrypoints/RendererParamsEntrypoint.cpp
  entrypoints/RequestModelUploadEntrypoint.cpp
  entrypoints/ResetCameraEntrypoint.cpp
  entrypoints/SceneEntrypoint.cpp
  entrypoints/SchemaEntrypoint.cpp
  entrypoints/SnapshotEntrypoint.cpp
  entrypoints/StatisticsEntrypoint.cpp
  entrypoints/TriggerJpegStreamEntrypoint.cpp
  entrypoints/UpdateClipPlaneEntrypoint.cpp
  entrypoints/UpdateInstanceEntrypoint.cpp
  entrypoints/UpdateModelEntrypoint.cpp
  entrypoints/VersionEntrypoint.cpp
  entrypoints/VolumeParametersEntrypoint.cpp
  interface/NetworkInterface.cpp
  jsonrpc/JsonRpcException.cpp
  jsonrpc/JsonRpcFactory.cpp
  jsonrpc/JsonRpcRequest.cpp
  jsonrpc/JsonRpcParser.cpp
  jsonrpc/JsonRpcSender.cpp
  jsonrpc/RequestId.cpp
  messages/LightMessage.cpp
  plugin/NetworkManager.cpp
  socket/ClientSocket.cpp
  socket/ServerSocket.cpp
  socket/SocketListener.cpp
  socket/SocketManager.cpp
  stream/StreamManager.cpp
  stream/StreamMonitor.cpp
  task/BinaryTask.cpp
  task/JsonRpcTask.cpp
  task/TaskManager.cpp
  websocket/InputPacket.cpp
  websocket/OutputPacket.cpp
  websocket/WebSocket.cpp
)

set(BRAYNSNETWORK_INCLUDE_DIR ${PROJECT_SOURCE_DIR})

add_library(braynsNetwork SHARED ${BRAYNSNETWORK_SOURCES} ${BRAYNSNETWORK_HEADERS})

target_include_directories(braynsNetwork PUBLIC
  $<BUILD_INTERFACE:${BRAYNSNETWORK_INCLUDE_DIR}>
  $<INSTALL_INTERFACE:include>)

target_link_libraries(braynsNetwork PRIVATE
  braynsCommon
  braynsParameters
  braynsPluginAPI
  braynsUtils
)

target_link_libraries(braynsNetwork PUBLIC
  braynsJson
  braynsIO
  Poco::Foundation
  Poco::Net
  Poco::NetSSL
)

target_compile_options(braynsNetwork PRIVATE ${BRAYNS_COMPILE_OPTIONS})

set_target_properties(braynsNetwork
    PROPERTIES
        VERSION ${BRAYNS_VERSION}
        SOVERSION ${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}
)

install(TARGETS braynsNetwork
    EXPORT Brayns-targets
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
)
