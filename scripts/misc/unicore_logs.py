import requests

TOKEN = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI5T0R3Z1JSTFVsTTJHbFphVDZjVklnenJsb0lzUWJmbTBDck1icXNjNHQ4In0.eyJleHAiOjE3MTQ0NzUzMjQsImlhdCI6MTcxNDQ3MTcyNCwiYXV0aF90aW1lIjoxNzE0NDYxNjIyLCJqdGkiOiJiZTkzNjhmZi01YzY0LTRiNTUtYTEwMC01ZjJkOWE4OTc3ZjQiLCJpc3MiOiJodHRwczovL2JicGF1dGguZXBmbC5jaC9hdXRoL3JlYWxtcy9CQlAiLCJhdWQiOlsiaHR0cHM6Ly9zbGFjay5jb20iLCJjb3Jlc2VydmljZXMtZ2l0bGFiIiwiYWNjb3VudCJdLCJzdWIiOiJmOjBmZGFkZWY3LWIyYjktNDkyYi1hZjQ2LWM2NTQ5MmQ0NTljMjpwZXRpdGplYSIsInR5cCI6IkJlYXJlciIsImF6cCI6ImJicC1icmF5bnNjaXJjdWl0c3R1ZGlvIiwic2Vzc2lvbl9zdGF0ZSI6ImE5YmJmODEyLTRiYjktNGFhYi1iYjYzLTBiMGIzNGEzOWU0YiIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vYnJheW5zY2lyY3VpdHN0dWRpby5rY3AuYmJwLmVwZmwuY2giLCJodHRwczovL2Rldi5icmF5bnNjaXJjdWl0c3R1ZGlvLmtjcC5iYnAuZXBmbC5jaCIsImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MCIsImh0dHBzOi8vczIuYnJheW5zY2lyY3VpdHN0dWRpby5rY3AuYmJwLmVwZmwuY2giLCJodHRwOi8vczIuYnJheW5zY2lyY3VpdHN0dWRpby5rY3AuYmJwLmVwZmwuY2giLCJodHRwOi8vbG9jYWxob3N0OjgwODEiLCJodHRwOi8vZGV2LmJyYXluc2NpcmN1aXRzdHVkaW8ua2NwLmJicC5lcGZsLmNoIiwiaHR0cHM6Ly9icmF5bnNjaXJjdWl0c3R1ZGlvLmtjcC5iYnAuZXBmbC5jaCIsImh0dHA6Ly9zMS5icmF5bnNjaXJjdWl0c3R1ZGlvLmtjcC5iYnAuZXBmbC5jaCIsImh0dHBzOi8vczMuYnJheW5zY2lyY3VpdHN0dWRpby5rY3AuYmJwLmVwZmwuY2giLCJodHRwOi8vczMuYnJheW5zY2lyY3VpdHN0dWRpby5rY3AuYmJwLmVwZmwuY2giLCJodHRwczovL3MxLmJyYXluc2NpcmN1aXRzdHVkaW8ua2NwLmJicC5lcGZsLmNoIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJiYnAtcGFtLWF1dGhlbnRpY2F0aW9uIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtYmJwIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiaHR0cHM6Ly9zbGFjay5jb20iOnsicm9sZXMiOlsicmVzdHJpY3RlZC1hY2Nlc3MiXX0sImNvcmVzZXJ2aWNlcy1naXRsYWIiOnsicm9sZXMiOlsicmVzdHJpY3RlZC1hY2Nlc3MiXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIG5leHVzIHByb2ZpbGUgbG9jYXRpb24gZ3JvdXBzIGVtYWlsIiwic2lkIjoiYTliYmY4MTItNGJiOS00YWFiLWJiNjMtMGIwYjM0YTM5ZTRiIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJGYWJpZW4gUGV0aXRqZWFuIiwibG9jYXRpb24iOiJCMSA0IDI2Ny4wNDAiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJwZXRpdGplYSIsImdpdmVuX25hbWUiOiJGYWJpZW4iLCJmYW1pbHlfbmFtZSI6IlBldGl0amVhbiIsImVtYWlsIjoiZmFiaWVuLnBldGl0amVhbkBlcGZsLmNoIn0.PBMBnkyxK9NFWCEPX1oNyH8KWKG0wO4Abw1B_Yc95R9_e-WUeTcBY1tbaF93mtSd-VGmmClGpahXVWTxgdUraSy-EsEdbXZdQZ7soKG-OwsDeR5KI3wh1bKXqlWDQglZxA-MbUIQ-979wt396CVuGJ5Vp0Gy46oArKvBqnI9Eez-pgdzeyxOsm_XcxkBIFxKIexsM5QVTyeVjxmU_9yLl5uUCcAslCubgYvwJFYUxekAGrkSSe6NPuRe6_c_8vfRV1fJp_zAhl2hAVZjtN5jUfcpDwtCD9SM8tmIDaD3rKLHGuq-FPCCcmAkKve9SM-VzEsgw7kS6wYiipsBb6zr0Q"
JOB_ID = "df5f2afa-5d02-4a2b-a694-ccf1ce8fe65d"
URL = "https://unicore.bbp.epfl.ch:8080/BB5-CSCS/rest/core/storages/{job_id}-uspace/files/stdout"
CA = "/home/acfleury/source/test/BBP_CA_ROOT_CERTIFICATE.crt"


def read_stdout(token: str, job_id: str) -> bytes:
    url = URL.format(job_id=job_id)
    headers = {
        "Authorization": f"Bearer {token}",
        "Accept": "application/octet-stream",
    }
    response = requests.get(url, headers=headers, verify=CA)
    response.raise_for_status()
    return response.content


if __name__ == "__main__":
    data = read_stdout(TOKEN, JOB_ID)
    print(data.decode())
