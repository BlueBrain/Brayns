stages:
  - test
  - publish

include:
  - project: viz/ci/gitlabpipelines
    file: index.yml

ubuntu-clangformat-check:
  stage: test
  image:
    name: ubuntu:22.04
  script:
    - apt update && apt install -y git clang-format-15
    - cd $CI_PROJECT_DIR
    - SOURCES=$(find apps src tests \( -name "*.h" -or -name "*.cpp" \))
    - clang-format-15 --dry-run --Werror $SOURCES
  rules:
    - if: $GITHUB_PULL_REQUEST_ID
